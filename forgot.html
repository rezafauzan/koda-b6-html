<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Koda - Coffee Shop | Forgot Password</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>

<body id="auth">
    <header>

    </header>
    <main>
        <section id="forgot-password">
            <div class="section-body">
                <div class="container">
                    <div class="side-image"></div>
                    <div class="form-container">
                        <div class="form-header">
                            <img src="assets/img/brand.svg" alt="Brand">
                            <span>Fill out the form correctly</span>
                            <span>We will send new password to your email</span>
                        </div>
                        <div class="form-body">
                            <form id="form-forgot-password">
                                <label for="email">Email</label>
                                <div class="input-wicon">
                                    <img src="assets/img/mail.svg" alt="mail_icon">
                                    <input type="email" name="email" id="email" placeholder="Email address">
                                </div>
                                <button type="submit" class="button button-primary">Submit</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <footer>

    </footer>
    <script src="assets/js/script.js"></script>
    <script>
        if (window.localStorage.getItem('isLogin') === 'true') {
            window.location.href = 'index.html'
        } else {
            $('#form-forgot-password').on('submit',
                e => {
                    e.preventDefault()
                    const formData = Object.fromEntries(new FormData($('#form-forgot-password')[0]).entries())
                    if ($('#alert') !== null) {
                        $('#alert').remove()
                    }

                    let users = []
                    if (window.localStorage.getItem('users') !== null) {
                        users = JSON.parse(window.localStorage.getItem('users'))
                    }

                    const user = users.find(pengguna => pengguna.email === formData.email)
                    if (user) {
                        if (!$('#alert-message-user-exist')[0]) {
                            $('#form-forgot-password').before(`<div id="alert" class="show alert-success"><span id="alert-message-user-exist">${alertData.forgot_user_exist}</span></div>`)
                        }
                    } else {
                        if (!$('#alert-message-user-not-exist')[0]) {
                            $('#form-forgot-password').before(`<div id="alert" class="show alert-fatal"><span id="alert-message-user-not-exist">${alertData.forgot_user_not_exist}</span></div>`)
                        }
                    }
                }
            )
        }
    </script>
</body>

</html>